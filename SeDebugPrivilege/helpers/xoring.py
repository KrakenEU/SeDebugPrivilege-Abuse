#!/usr/bin/env python3

from Crypto.Util.number import bytes_to_long, long_to_bytes  
src_file = open('C:\\Temp\\rtl.bin','rb')
src_data = src_file.read()
dst_file = open('C:\\Temp\\xored.bin', 'wb')
  
key =  [
    0xED, 0x3A, 0x45, 0x89, 0x5F, 0xC1, 0x9B, 0x27,
    0x63, 0xB8, 0xE4, 0x9F, 0xD0, 0x6C, 0x2A, 0x71,
    0xAD, 0x4E, 0x53, 0x96, 0x37, 0xA9, 0x7B, 0xCD,
    0xFA, 0x12, 0xBE, 0x38, 0x5A, 0xF1, 0x84, 0x6D,
    0xF9, 0x3D, 0x21, 0x67, 0x9A, 0xE7, 0xC8, 0x5B,
    0xD3, 0xA1, 0x7F, 0x49, 0x36, 0xC0, 0xEE, 0x8B,
    0x4A, 0x73, 0x90, 0xD5, 0x2E, 0xF7, 0x61, 0xB2,
    0x81, 0x15, 0xC6, 0x9E, 0x50, 0xDB, 0x3C, 0x24
]
result = b''
n = 0
for d in range(0,len(src_data)):
    if n >= len(key):
        n=0
    result+=long_to_bytes(src_data[d]^key[n])
    n += 1  

src_file.close()
dst_file.write(result)
dst_file.close()